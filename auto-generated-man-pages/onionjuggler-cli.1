.\" Automatically generated by Pandoc 2.9.2.1
.\"
.TH "onionjuggler-cli" "1" "September 2069" "Dinamically juggle with onion services with a POSIX compliant shell" ""
.hy
.SH NAME
.PP
onionjuggler-cli - Dinamically juggle with onion services with a POSIX
compliant shell
.SH SYNOPSIS
.PP
\f[B]onionjuggler-cli\f[R] [\f[B]--option\f[R]<=\f[I]ARGUMENT\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli [--getconf]\f[R]
.PD 0
.P
.PD
\f[B]onionjuggler-cli [--getopt]\f[R] [\f[B]--service\f[R]
<\f[I]SERVICE\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli --on\f[R] [\f[B]--service\f[R]
<\f[I]SERVICE\f[R]>] [\f[B]--version\f[R] <\f[I]VERSION\f[R]>]
[\f[B]--socket\f[R] <\f[I]tcp\f[R]>] [\f[B]--port\f[R]
<\f[I]VIRTPORT\f[R][:\f[I]TARGET\f[R]],[\f[I]VIRTPORTn\f[R]][:\f[I]TARGETn\f[R]]>]
[\f[B]--gateway\f[R]]
.PD 0
.P
.PD
\f[B]onionjuggler-cli --on\f[R] [\f[B]--service\f[R]
<\f[I]SERVICE\f[R]>] [\f[B]--version\f[R] <\f[I]VERSION\f[R]>]
[\f[B]--socket\f[R] <\f[I]unix\f[R]>] [\f[B]--port\f[R]
[\f[I]VIRTPORT\f[R],[\f[I]VIRTPORT2\f[R]]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli --off\f[R] [\f[B]--service\f[R]
<\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>] [\f[B]--purge\f[R]]
.PD 0
.P
.PD
\f[B]onionjuggler-cli --list\f[R] [\f[B]--service\f[R]
<\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>]
[\f[B]--quiet\f[R]]
.PD 0
.P
.PD
\f[B]onionjuggler-cli --renew\f[R] [\f[B]--service\f[R]
<\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli\f[R] [\f[B]-h\f[R]|\f[B]--help\f[R]]
.SH DESCRIPTION
.PP
\f[B]onionjuggler-cli\f[R] helps onion service creation, deletion,
listing.
.SH OPTIONS
.SS VARIABLES
.TP
\f[B][VAR]\f[R]
Variable is required.
.TP
\f[B]<\f[BI]VAR\f[B]>\f[R]
Variable is optional.
.TP
\f[B]\[at]all\f[R], \f[B]\[at]all\f[R]
Include all available services or clients.
.TP
\f[B]SERV1,SERV2...\f[R], \f[B]CLIENT1,CLIENT2,...\f[R], \f[B]ONION1,ONION2\f[R]
List enabled option.
e.g: ssh,xmpp,irc or alice,bob.
.TP
\f[B]VERSION\f[R]
Onion service version.
Currently only valid value is 3.
.TP
\f[B]SERV\f[R]
Service name.
String format.
.TP
\f[B]VIRTPORT\f[R]
Virtual port.
Integer format.
.TP
\f[B]TARGET\f[R]
Target socket.
TCP needs to be specified, the format is \f[I]addr:port\f[R].
Abscense of the address will bind to localhost using the address
\f[I]127.0.0.1\f[R] for uniformity.
Abscense of target and will use the same port as the virtual port,
specifying just the port will bind to localhost using the address
\f[I]127.0.0.1\f[R] for uniformity.
Unix target is handled by the code using the format \f[I]unix:path\f[R]
and does not require manual selection.
Integer format.
.TP
\f[B]ONION\f[R]
Onion address of the authenticated service for the client to connect to.
Only accepted format is for onion v3 addresses, which contains 56
characters using the base32 format with the range \f[I]a-z2-7\f[R] and
ending with (dot)onion.
String format.
.TP
\f[B]main\f[R] [\f[B]--option\f[R]<=\f[I]ARGUMENT\f[R]>]
Commands that accept arguments can be specified as follow:
\f[I]--service ssh\f[R] OR \f[I]--service \[dq]ssh nextcloud\[dq]\f[R]
OR \f[I]--service=ssh,nextcloud\f[R]
.TP
\f[B]ssh\f[R], \f[B]xmpp\f[R], \f[B]nextcloud\f[R]
Example of onion services directory names.
.SS ARGUMENTS
.TP
\f[B]--getconf\f[R]
Print configuration in the format \f[B]key\f[R]=\[dq]\f[I]val\f[R]\[dq].
.TP
\f[B]--getopt\f[R]
Print option parsing results.
.TP
\f[B]--on\f[R] \f[B]--service\f[R] <\f[I]SERV\f[R]> \f[B]--version\f[R] \f[I]3\f[R] \f[B]--socket\f[R] \f[I]tcp\f[R] \f[B]--port\f[R] <\f[I]VIRTPORT\f[R]:<\f[I]TARGET\f[R]>,<\f[I]VIRTPORTn\f[R]>:<\f[I]TARGETn\f[R]>> \f[B]--gateway\f[R]
Enable an onion service using TCP socket (addr:port) as target.
If the TARGET is only the port of it TARGET was not provided, will use
the same port as VIRTPORT and bind to 127.0.0.1.
TARGET examples: 127.0.0.1:80, 192.168.1.100:80.
File(s) modified: torrc.
.RS
.IP
.nf
\f[C]
onionjuggler-cli --on --service ssh --version 3 --socket tcp --port 22
onionjuggler-cli --on --service ssh --port 22:127.0.1:22
onionjuggler-cli --on --service ssh --port \[dq]80:127.0.0.1:80 443:127.0.0.1:443\[dq]
onionjuggler-cli --on --service ssh --port \[dq]80:127.0.0.1:80,443:127.0.0.1:443\[dq]
onionjuggler-cli --on --service ssh --port=\[dq]80,443\[dq]
\f[R]
.fi
.PP
By default, services created on a Qubes-Whonix Gateway uses the Whonix
Workstation qube IP address, services created on a Non-Qubes-Whonix uses
the IP address 10.152.152.11.
If you are on Whonix Gateway want to enforce the creation of a service
to be running on the Whonix-Gateway (for itself), for example and onion
service to ssh to the Gateway, and you haven\[aq]t set the target, just
the virtual port, use the option \f[I]--gateway\f[R]:
.IP
.nf
\f[C]
onionjuggler-cli --on --service ssh --socket tcp --port 22 --gateway
\f[R]
.fi
.RE
.TP
\f[B]--on\f[R] \f[B]--service\f[R] <\f[I]SERV\f[R]> \f[B]--version\f[R] \f[I]3\f[R] \f[B]--socket\f[R] \f[I]unix\f[R] \f[B]--port\f[R] <\f[I]VIRTPORT\f[R],<\f[I]VIRTPORT2\f[R]>>
Enable an onion service using UNIX socket (unix:path) as target.
The TARGET is handled automatically by the script.
This method avoids leaking the onion service address to the local
network.
File(s) modified: torrc.
.RS
.IP
.nf
\f[C]
onionjuggler-cli --on --service ssh --version 3 --socket unix --port 22
onionjuggler-cli --on --service ssh --version 3 --socket unix --port 22,80
\f[R]
.fi
.RE
.TP
\f[B]--off\f[R] \f[B]--service\f[R] <\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]> <\f[I]--purge\f[R]>
Disable an onion service by removing it configuration lines
(HiddenService) from the torrc.
Optionally purge its data directory, which will delete permanently the
onion service folder (HiddenServiceDir).
File(s) modified: torrc and optionally HiddenServiceDir.
.RS
.IP
.nf
\f[C]
onionjuggler-cli --off --service ssh
onionjuggler-cli --off --service ssh,xmpp
onionjuggler-cli --off --service ssh,xmpp --purge
\f[R]
.fi
.RE
.PP
\f[B]--list\f[R] \f[B]--service\f[R]
<\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>
<\f[I]--quiet\f[R]>
.PP
List onion service information: hostname (address) and in QR encoded
format, clients names and quantity, status if service is active or
inactive regarding the torrc lines (un)present and the HiddenServiceDir
presence, the torrc block.
File(s) modified: none.
.IP
.nf
\f[C]
onionjuggler-cli --list --service ssh
onionjuggler-cli --list --service ssh,xmpp
onionjuggler-cli --list --service \[at]all
onionjuggler-cli --list --service \[at]all --quiet
\f[R]
.fi
.TP
\f[B]--renew\f[R] \f[B]--service\f[R] <\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>
Renew onion service hostname (.onion domain) and clients (inside
HiddenServiceDir/authorized_clients/).
The onion service keys (hs_ed25519_public_key and
hs_ed25519_private_key) will be removed to override the hostname file.
File(s) modified: HiddenServiceDir.
.RS
.IP
.nf
\f[C]
onionjuggler-cli --renew --service ssh
onionjuggler-cli --renew --service ssh,xmpp
onionjuggler-cli --renew --service \[at]all
\f[R]
.fi
.RE
.TP
\f[B]-h\f[R], \f[B]--help\f[R]
Display the script help message.
Abscense of any parameter will also have the same effect.
.RS
.IP
.nf
\f[C]
onionjuggler-cli -h
onionjuggler-cli --help
\f[R]
.fi
.RE
.TP
\f[B]-R\f[R], \f[B]--restart\f[R], \f[B]-r\f[R], \f[B]--reload\f[R]
Signal tor daemon to restart or reload after the CLI edits tor\[aq]s
configuration files.
(Default: reload)
.SH FILES
.TP
\f[B]/usr/share/onionjuggler/defaults.sh\f[R]
Default library
.TP
\f[B]/etc/onionjuggler/onionjuggler.conf\f[R]
Default system configuration file.
.TP
\f[B]/etc/onionjuggler/conf.d/*.conf\f[R]
Local configuration files that overrrite the default one.
.SH EXIT VALUE
.TP
\f[B]0\f[R]
Success
.TP
\f[B]>0\f[R]
Fail
.SH BUGS
.PP
Bugs you may find.
First search for related issues on
https://github.com/nyxnor/onionjuggler/issues, if not solved, open a new
one.
.SH SEE ALSO
.PP
onionjuggler-tui(1), onionjuggler.conf(5), vitor(8), tor(1), sh(1),
regex(7), sed(1), grep(1), shellcheck(1)
.SH COPYRIGHT
.PP
Copyright \[co] 2021 OnionJuggler developers (MIT) This is free
software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
.SH AUTHORS
Written by nyxnor (nyxnor\[at]protonmail.com).
